---
output: html_document
editor_options: 
  chunk_output_type: console
---
...
title: "rMATS analysis"
author: "Shay Iyer"
date: "`r Sys.Date()`"
output: html_document
editor_options: 
  chunk_output_type: console
...

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(maser)
library(rtracklayer)
library(gridExtra) 
```

```{r maser path definition}
ips.s1s2.path <- "/Volumes/sheynkman/projects/EC_stem_cell_differentiation/001_ips-s1s2/003_ips-s1s2_output/002_ips-s1s2_rmats-out"
```

```{r maser objects definition}
#using JCEC for statistical power
ips.s1s2 <- maser(path = ips.s1s2.path, cond_labels = c("iPS", "S1S2-iEC"), ftype = "JCEC")
```

# PreProcessing for mapping script, 10/22/22

```{r}
SE <- summary(ips.s1s2, type = "SE")[] %>% as.data.frame() %>% mutate("EventType" = rep("SE")) %>% filter(Chr == "chr19") %>% filter(FDR < 0.05)
MXE <- summary(ips.s1s2, type = "MXE")[] %>% as.data.frame() %>% mutate("EventType" = rep("MXE")) %>% filter(Chr == "chr19") %>% filter(FDR < 0.05)
A5SS <- summary(ips.s1s2, type = "A5SS")[] %>% as.data.frame() %>% mutate("EventType" = rep("A5SS"))%>% filter(Chr == "chr19") %>% filter(FDR < 0.05)
A3SS <- summary(ips.s1s2, type = "A3SS")[] %>% as.data.frame() %>% mutate("EventType" = rep("A3SS")) %>% filter(Chr == "chr19") %>% filter(FDR < 0.05)
```


```{r}
SE %>% write.csv(file = "/Volumes/sheynkman/projects/shay_thesis/data/seToy.csv")
MXE %>% write.csv(file = "/Volumes/sheynkman/projects/shay_thesis/data/mxeToy.csv")
A5SS %>% write.csv(file = "/Volumes/sheynkman/projects/shay_thesis/data/a5ssToy.csv")
A3SS %>% write.csv(file = "/Volumes/sheynkman/projects/shay_thesis/data/a3ssToy.csv")
```

```{r not using retained intron for 10/23/22}
RI <- summary(ips.s1s2, type = "RI")[] %>% as.data.frame() %>% mutate("EventType" = rep("RI")) 
RI %>% write.csv(file = "/Volumes/sheynkman/projects/shay_thesis/data/riToy.csv")
```


